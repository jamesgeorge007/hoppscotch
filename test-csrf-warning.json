{
  "v": 10,
  "id": "test-csrf-warning",
  "name": "Test CSRF Warning Inspector",
  "folders": [],
  "requests": [
    {
      "v": "16",
      "name": "same-origin-fetch-pre-request",
      "method": "GET",
      "endpoint": "https://echo.hoppscotch.io",
      "params": [],
      "headers": [],
      "preRequestScript": "// This should trigger the CSRF warning\nconst response = await fetch('/api/user/profile')\nconst data = await response.json()\nconsole.log('User data:', data)",
      "testScript": "",
      "auth": {"authType": "inherit", "authActive": true},
      "body": {"contentType": null, "body": null},
      "requestVariables": [],
      "responses": {},
      "_ref_id": "req_csrf_pre"
    },
    {
      "v": "16",
      "name": "same-origin-fetch-post-request",
      "method": "GET",
      "endpoint": "https://echo.hoppscotch.io",
      "params": [],
      "headers": [],
      "preRequestScript": "",
      "testScript": "// This should trigger the CSRF warning\nconst response = await fetch('./api/data')\nconst result = await response.json()\nhopp.test('Data loaded', () => {\n  hopp.expect(result).toBeDefined()\n})",
      "auth": {"authType": "inherit", "authActive": true},
      "body": {"contentType": null, "body": null},
      "requestVariables": [],
      "responses": {},
      "_ref_id": "req_csrf_post"
    },
    {
      "v": "16",
      "name": "same-origin-fetch-both-scripts",
      "method": "GET",
      "endpoint": "https://echo.hoppscotch.io",
      "params": [],
      "headers": [],
      "preRequestScript": "// Fetch in pre-request\nconst settings = await fetch('../api/settings')\nhopp.env.active.set('settings', await settings.json())",
      "testScript": "// Fetch in post-request too\nconst status = await fetch('/api/status')\nhopp.test('Status check', () => {\n  hopp.expect(status.ok).toBe(true)\n})",
      "auth": {"authType": "inherit", "authActive": true},
      "body": {"contentType": null, "body": null},
      "requestVariables": [],
      "responses": {},
      "_ref_id": "req_csrf_both"
    },
    {
      "v": "16",
      "name": "location-origin-fetch",
      "method": "GET",
      "endpoint": "https://echo.hoppscotch.io",
      "params": [],
      "headers": [],
      "preRequestScript": "// Uses window.location.origin - should trigger warning\nconst url = window.location.origin + '/api/data'\nconst response = await fetch(url)\nconsole.log('Response:', response)",
      "testScript": "",
      "auth": {"authType": "inherit", "authActive": true},
      "body": {"contentType": null, "body": null},
      "requestVariables": [],
      "responses": {},
      "_ref_id": "req_csrf_location"
    },
    {
      "v": "16",
      "name": "external-url-no-warning",
      "method": "GET",
      "endpoint": "https://echo.hoppscotch.io",
      "params": [],
      "headers": [],
      "preRequestScript": "// This should NOT trigger warning - external URL\nconst response = await fetch('https://api.example.com/data')\nconst data = await response.json()\nconsole.log('External data:', data)",
      "testScript": "",
      "auth": {"authType": "inherit", "authActive": true},
      "body": {"contentType": null, "body": null},
      "requestVariables": [],
      "responses": {},
      "_ref_id": "req_no_warning"
    }
  ],
  "auth": {"authType": "inherit", "authActive": true},
  "headers": [],
  "variables": [],
  "_ref_id": "coll_csrf"
}
